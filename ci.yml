schemaVersion: v0.2
prepare:
  steps:
    - name: Update nix
      command: curl -L https://nixos.org/nix/install | sh
    - name: Prepare Flutter Environment
      command: nix-env -i -f ~/app/configuration.nix
    - name: Install Dependencies
      command: cd /home/user/app/demo_app/ && flutter clean && flutter pub get
    - name: Build App
      command: cd /home/user/app/demo_app/ && flutter build web
test:
  steps: []
run:
  app:
    steps:
      - name: Start webserver
        command: cd /home/user/app/demo_app/ && python3 -m http.server 3000
    plan: 101
    replicas: 1
    network:
      ports:
        - port: 3000
          isPublic: false
      paths:
        - port: 3000
          path: /
          stripPath: false
